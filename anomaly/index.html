
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="river-torch is a Python library for incremental deep learning and serves as extension for river.">
      
      
        <meta name="author" content="Cedric Kulbach">
      
      
        <link rel="canonical" href="https://github.com/kulbachcedric/river-torch/anomaly/">
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-8.1.11">
    
    
      
        <title>Anomaly - river-torch</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.50e68009.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.e6a45f82.min.css">
        
          
          
          <meta name="theme-color" content="#4051b5">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Rubik:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font:"Rubik";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#anomaly-detection" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-component="outdated" hidden>
        <aside class="md-banner md-banner--warning">
          
        </aside>
      </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="river-torch" class="md-header__button md-logo" aria-label="river-torch" data-md-component="logo">
      
  <img src="../img/logo_square.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            river-torch
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Anomaly
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/online-ml/river-torch/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    river-torch
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href=".." class="md-tabs__link">
      Home
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../installation/" class="md-tabs__link">
      Installation
    </a>
  </li>

      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="./" class="md-tabs__link md-tabs__link--active">
        Code Reference
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../examples/example_autoencoder/" class="md-tabs__link">
        Examples
      </a>
    </li>
  

      
        
  
  


  <li class="md-tabs__item">
    <a href="../about/" class="md-tabs__link">
      About
    </a>
  </li>

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="river-torch" class="md-nav__button md-logo" aria-label="river-torch" data-md-component="logo">
      
  <img src="../img/logo_square.png" alt="logo">

    </a>
    river-torch
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/online-ml/river-torch/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    river-torch
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../installation/" class="md-nav__link">
        Installation
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" checked>
      
      
      
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_3">
          Code Reference
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Code Reference" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Code Reference
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Anomaly
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Anomaly
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#river_torch.anomaly" class="md-nav__link">
    river_torch.anomaly
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#river_torch.anomaly.base" class="md-nav__link">
    base
  </a>
  
    <nav class="md-nav" aria-label="base">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#river_torch.anomaly.base.AnomalyScaler" class="md-nav__link">
    AnomalyScaler
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#river_torch.anomaly.base.Autoencoder" class="md-nav__link">
    Autoencoder
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#river_torch.anomaly.probability_weighted_ae" class="md-nav__link">
    probability_weighted_ae
  </a>
  
    <nav class="md-nav" aria-label="probability_weighted_ae">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#river_torch.anomaly.probability_weighted_ae.ProbabilityWeightedAutoencoder" class="md-nav__link">
    ProbabilityWeightedAutoencoder
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#river_torch.anomaly.rolling_ae" class="md-nav__link">
    rolling_ae
  </a>
  
    <nav class="md-nav" aria-label="rolling_ae">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#river_torch.anomaly.rolling_ae.RollingAutoencoder" class="md-nav__link">
    RollingAutoencoder
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#river_torch.anomaly.scaler" class="md-nav__link">
    scaler
  </a>
  
    <nav class="md-nav" aria-label="scaler">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#river_torch.anomaly.scaler.MeanScaler" class="md-nav__link">
    MeanScaler
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#river_torch.anomaly.scaler.MinMaxScaler" class="md-nav__link">
    MinMaxScaler
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#river_torch.anomaly.scaler.StandardScaler" class="md-nav__link">
    StandardScaler
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../classification/" class="md-nav__link">
        Classification
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../regression/" class="md-nav__link">
        Regression
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      
      
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_4">
          Examples
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Examples" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Examples
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../examples/example_autoencoder/" class="md-nav__link">
        Anomaly Detection
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../examples/example_classification/" class="md-nav__link">
        Classification
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../examples/example_regression/" class="md-nav__link">
        Bike-sharing forecasting
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../about/" class="md-nav__link">
        About
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#river_torch.anomaly" class="md-nav__link">
    river_torch.anomaly
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#river_torch.anomaly.base" class="md-nav__link">
    base
  </a>
  
    <nav class="md-nav" aria-label="base">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#river_torch.anomaly.base.AnomalyScaler" class="md-nav__link">
    AnomalyScaler
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#river_torch.anomaly.base.Autoencoder" class="md-nav__link">
    Autoencoder
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#river_torch.anomaly.probability_weighted_ae" class="md-nav__link">
    probability_weighted_ae
  </a>
  
    <nav class="md-nav" aria-label="probability_weighted_ae">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#river_torch.anomaly.probability_weighted_ae.ProbabilityWeightedAutoencoder" class="md-nav__link">
    ProbabilityWeightedAutoencoder
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#river_torch.anomaly.rolling_ae" class="md-nav__link">
    rolling_ae
  </a>
  
    <nav class="md-nav" aria-label="rolling_ae">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#river_torch.anomaly.rolling_ae.RollingAutoencoder" class="md-nav__link">
    RollingAutoencoder
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#river_torch.anomaly.scaler" class="md-nav__link">
    scaler
  </a>
  
    <nav class="md-nav" aria-label="scaler">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#river_torch.anomaly.scaler.MeanScaler" class="md-nav__link">
    MeanScaler
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#river_torch.anomaly.scaler.MinMaxScaler" class="md-nav__link">
    MinMaxScaler
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#river_torch.anomaly.scaler.StandardScaler" class="md-nav__link">
    StandardScaler
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
<a href="https://github.com/online-ml/river-torch/anomaly.md" title="Edit this page" class="md-content__button md-icon">
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
</a>


<h1 id="anomaly-detection">Anomaly Detection<a class="headerlink" href="#anomaly-detection" title="Permanent link">&para;</a></h1>


  <div class="doc doc-object doc-module">

<a id="river_torch.anomaly"></a>
    <div class="doc doc-contents first">




  <div class="doc doc-children">











  <div class="doc doc-object doc-module">



<h2 id="river_torch.anomaly.base" class="doc doc-heading">
        <code>base</code>



<a href="#river_torch.anomaly.base" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">




  <div class="doc doc-children">







  <div class="doc doc-object doc-class">



<h3 id="river_torch.anomaly.base.AnomalyScaler" class="doc doc-heading">
        <code>
AnomalyScaler            (<span title="river.base.wrapper.Wrapper">Wrapper</span>, <span title="river.anomaly.base.AnomalyDetector">AnomalyDetector</span>)
        </code>



<a href="#river_torch.anomaly.base.AnomalyScaler" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Wrapper around an anomaly detector that scales the output of the model to account for drift in the wrapped model's anomaly scores.</p>
<h5 id="river_torch.anomaly.base.AnomalyScaler--parameters">Parameters<a class="headerlink" href="#river_torch.anomaly.base.AnomalyScaler--parameters" title="Permanent link">&para;</a></h5>
<p>anomaly_detector
    Anomaly detector to be wrapped.</p>

        <details class="quote">
          <summary>Source code in <code>river_torch/anomaly/base.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">AnomalyScaler</span><span class="p">(</span><span class="n">base</span><span class="o">.</span><span class="n">Wrapper</span><span class="p">,</span> <span class="n">anomaly</span><span class="o">.</span><span class="n">base</span><span class="o">.</span><span class="n">AnomalyDetector</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Wrapper around an anomaly detector that scales the output of the model to account for drift in the wrapped model&#39;s anomaly scores.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    anomaly_detector</span>
<span class="sd">        Anomaly detector to be wrapped.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">anomaly_detector</span><span class="p">:</span> <span class="n">anomaly</span><span class="o">.</span><span class="n">base</span><span class="o">.</span><span class="n">AnomalyDetector</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">anomaly_detector</span> <span class="o">=</span> <span class="n">anomaly_detector</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_unit_test_params</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a dictionary of parameters to be used for unit testing the respective class.</span>

<span class="sd">        Yields</span>
<span class="sd">        -------</span>
<span class="sd">        dict</span>
<span class="sd">            Dictionary of parameters to be used for unit testing the respective class.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">yield</span> <span class="p">{</span><span class="s2">&quot;anomaly_detector&quot;</span><span class="p">:</span> <span class="n">anomaly</span><span class="o">.</span><span class="n">HalfSpaceTrees</span><span class="p">()}</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_unit_test_skips</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">set</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Indicates which checks to skip during unit testing.</span>
<span class="sd">        Most estimators pass the full test suite. However, in some cases, some estimators might not</span>
<span class="sd">        be able to pass certain checks.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        set</span>
<span class="sd">            Set of checks to skip during unit testing.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;check_pickling&quot;</span><span class="p">,</span>
            <span class="s2">&quot;check_shuffle_features_no_impact&quot;</span><span class="p">,</span>
            <span class="s2">&quot;check_emerging_features&quot;</span><span class="p">,</span>
            <span class="s2">&quot;check_disappearing_features&quot;</span><span class="p">,</span>
            <span class="s2">&quot;check_predict_proba_one&quot;</span><span class="p">,</span>
            <span class="s2">&quot;check_predict_proba_one_binary&quot;</span><span class="p">,</span>
        <span class="p">}</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">_wrapped_model</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">anomaly_detector</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">score_one</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Return a scaled anomaly score based on raw score provided by the wrapped anomaly detector.</span>

<span class="sd">        A high score is indicative of an anomaly. A low score corresponds to a normal observation.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        *args</span>
<span class="sd">            Depends on whether the underlying anomaly detector is supervised or not.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        An scaled anomaly score. Larger values indicate more anomalous examples.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">learn_one</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;AnomalyScaler&quot;</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Update the scaler and the underlying anomaly scaler.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        *args</span>
<span class="sd">            Depends on whether the underlying anomaly detector is supervised or not.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        AnomalyScaler</span>
<span class="sd">            The model itself.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">anomaly_detector</span><span class="o">.</span><span class="n">learn_one</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">










  <div class="doc doc-object doc-method">



<h4 id="river_torch.anomaly.base.AnomalyScaler.learn_one" class="doc doc-heading">
<code class="highlight language-python"><span class="n">learn_one</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span></code>


<a href="#river_torch.anomaly.base.AnomalyScaler.learn_one" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Update the scaler and the underlying anomaly scaler.</p>
<h6 id="river_torch.anomaly.base.AnomalyScaler.learn_one--parameters">Parameters<a class="headerlink" href="#river_torch.anomaly.base.AnomalyScaler.learn_one--parameters" title="Permanent link">&para;</a></h6>
<p>*args
    Depends on whether the underlying anomaly detector is supervised or not.</p>
<h6 id="river_torch.anomaly.base.AnomalyScaler.learn_one--returns">Returns<a class="headerlink" href="#river_torch.anomaly.base.AnomalyScaler.learn_one--returns" title="Permanent link">&para;</a></h6>
<p>AnomalyScaler
    The model itself.</p>

        <details class="quote">
          <summary>Source code in <code>river_torch/anomaly/base.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">learn_one</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;AnomalyScaler&quot;</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Update the scaler and the underlying anomaly scaler.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    *args</span>
<span class="sd">        Depends on whether the underlying anomaly detector is supervised or not.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    AnomalyScaler</span>
<span class="sd">        The model itself.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">anomaly_detector</span><span class="o">.</span><span class="n">learn_one</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="river_torch.anomaly.base.AnomalyScaler.score_one" class="doc doc-heading">
<code class="highlight language-python"><span class="n">score_one</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span></code>


<a href="#river_torch.anomaly.base.AnomalyScaler.score_one" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Return a scaled anomaly score based on raw score provided by the wrapped anomaly detector.</p>
<p>A high score is indicative of an anomaly. A low score corresponds to a normal observation.</p>
<h6 id="river_torch.anomaly.base.AnomalyScaler.score_one--parameters">Parameters<a class="headerlink" href="#river_torch.anomaly.base.AnomalyScaler.score_one--parameters" title="Permanent link">&para;</a></h6>
<p>*args
    Depends on whether the underlying anomaly detector is supervised or not.</p>
<h6 id="river_torch.anomaly.base.AnomalyScaler.score_one--returns">Returns<a class="headerlink" href="#river_torch.anomaly.base.AnomalyScaler.score_one--returns" title="Permanent link">&para;</a></h6>
<p>An scaled anomaly score. Larger values indicate more anomalous examples.</p>

        <details class="quote">
          <summary>Source code in <code>river_torch/anomaly/base.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
<span class="k">def</span> <span class="nf">score_one</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Return a scaled anomaly score based on raw score provided by the wrapped anomaly detector.</span>

<span class="sd">    A high score is indicative of an anomaly. A low score corresponds to a normal observation.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    *args</span>
<span class="sd">        Depends on whether the underlying anomaly detector is supervised or not.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    An scaled anomaly score. Larger values indicate more anomalous examples.</span>
<span class="sd">    &quot;&quot;&quot;</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h3 id="river_torch.anomaly.base.Autoencoder" class="doc doc-heading">
        <code>
Autoencoder            (<span title="river_torch.base.DeepEstimator">DeepEstimator</span>, <span title="river.anomaly.base.AnomalyDetector">AnomalyDetector</span>)
        </code>



<a href="#river_torch.anomaly.base.Autoencoder" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Wrapper for PyTorch autoencoder models that uses the networks reconstruction error for scoring the anomalousness of a given example.</p>
<h5 id="river_torch.anomaly.base.Autoencoder--parameters">Parameters<a class="headerlink" href="#river_torch.anomaly.base.Autoencoder--parameters" title="Permanent link">&para;</a></h5>
<p>build_fn
    Function that builds the autoencoder to be wrapped. The function should accept parameter <code>n_features</code> so that the returned model's input shape can be determined based on the number of features in the initial training example.
loss_fn
    Loss function to be used for training the wrapped model. Can be a loss function provided by <code>torch.nn.functional</code> or one of the following: 'mse', 'l1', 'cross_entropy', 'binary_crossentropy', 'smooth_l1', 'kl_div'.
optimizer_fn
    Optimizer to be used for training the wrapped model. Can be an optimizer class provided by <code>torch.optim</code> or one of the following: "adam", "adam_w", "sgd", "rmsprop", "lbfgs".
lr
    Learning rate of the optimizer.
device
    Device to run the wrapped model on. Can be "cpu" or "cuda".
seed
    Random seed to be used for training the wrapped model.
**net_params
    Parameters to be passed to the <code>build_fn</code> function aside from <code>n_features</code>.</p>

        <details class="quote">
          <summary>Source code in <code>river_torch/anomaly/base.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">Autoencoder</span><span class="p">(</span><span class="n">DeepEstimator</span><span class="p">,</span> <span class="n">anomaly</span><span class="o">.</span><span class="n">base</span><span class="o">.</span><span class="n">AnomalyDetector</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Wrapper for PyTorch autoencoder models that uses the networks reconstruction error for scoring the anomalousness of a given example.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    build_fn</span>
<span class="sd">        Function that builds the autoencoder to be wrapped. The function should accept parameter `n_features` so that the returned model&#39;s input shape can be determined based on the number of features in the initial training example.</span>
<span class="sd">    loss_fn</span>
<span class="sd">        Loss function to be used for training the wrapped model. Can be a loss function provided by `torch.nn.functional` or one of the following: &#39;mse&#39;, &#39;l1&#39;, &#39;cross_entropy&#39;, &#39;binary_crossentropy&#39;, &#39;smooth_l1&#39;, &#39;kl_div&#39;.</span>
<span class="sd">    optimizer_fn</span>
<span class="sd">        Optimizer to be used for training the wrapped model. Can be an optimizer class provided by `torch.optim` or one of the following: &quot;adam&quot;, &quot;adam_w&quot;, &quot;sgd&quot;, &quot;rmsprop&quot;, &quot;lbfgs&quot;.</span>
<span class="sd">    lr</span>
<span class="sd">        Learning rate of the optimizer.</span>
<span class="sd">    device</span>
<span class="sd">        Device to run the wrapped model on. Can be &quot;cpu&quot; or &quot;cuda&quot;.</span>
<span class="sd">    seed</span>
<span class="sd">        Random seed to be used for training the wrapped model.</span>
<span class="sd">    **net_params</span>
<span class="sd">        Parameters to be passed to the `build_fn` function aside from `n_features`.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">build_fn</span><span class="p">:</span> <span class="n">Callable</span><span class="p">,</span>
        <span class="n">loss_fn</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Callable</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;mse&quot;</span><span class="p">,</span>
        <span class="n">optimizer_fn</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Callable</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;sgd&quot;</span><span class="p">,</span>
        <span class="n">lr</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-3</span><span class="p">,</span>
        <span class="n">device</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;cpu&quot;</span><span class="p">,</span>
        <span class="n">seed</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">42</span><span class="p">,</span>
        <span class="o">**</span><span class="n">net_params</span>
    <span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">build_fn</span><span class="o">=</span><span class="n">build_fn</span><span class="p">,</span>
            <span class="n">loss_fn</span><span class="o">=</span><span class="n">loss_fn</span><span class="p">,</span>
            <span class="n">optimizer_fn</span><span class="o">=</span><span class="n">optimizer_fn</span><span class="p">,</span>
            <span class="n">lr</span><span class="o">=</span><span class="n">lr</span><span class="p">,</span>
            <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">,</span>
            <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">,</span>
            <span class="o">**</span><span class="n">net_params</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_unit_test_params</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a dictionary of parameters to be used for unit testing the respective class.</span>

<span class="sd">        Yields</span>
<span class="sd">        -------</span>
<span class="sd">        dict</span>
<span class="sd">            Dictionary of parameters to be used for unit testing the respective class.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">def</span> <span class="nf">build_fn</span><span class="p">(</span><span class="n">n_features</span><span class="p">):</span>
            <span class="n">latent_dim</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">n_features</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">nn</span><span class="o">.</span><span class="n">Sequential</span><span class="p">(</span>
                <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">n_features</span><span class="p">,</span> <span class="n">latent_dim</span><span class="p">),</span>
                <span class="n">nn</span><span class="o">.</span><span class="n">LeakyReLU</span><span class="p">(),</span>
                <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">latent_dim</span><span class="p">,</span> <span class="n">n_features</span><span class="p">),</span>
            <span class="p">)</span>

        <span class="k">yield</span> <span class="p">{</span>
            <span class="s2">&quot;build_fn&quot;</span><span class="p">:</span> <span class="n">build_fn</span><span class="p">,</span>
            <span class="s2">&quot;loss_fn&quot;</span><span class="p">:</span> <span class="s2">&quot;mse&quot;</span><span class="p">,</span>
            <span class="s2">&quot;optimizer_fn&quot;</span><span class="p">:</span> <span class="s2">&quot;sgd&quot;</span><span class="p">,</span>
        <span class="p">}</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_unit_test_skips</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">set</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Indicates which checks to skip during unit testing.</span>
<span class="sd">        Most estimators pass the full test suite. However, in some cases, some estimators might not</span>
<span class="sd">        be able to pass certain checks.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        set</span>
<span class="sd">            Set of checks to skip during unit testing.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;check_pickling&quot;</span><span class="p">,</span>
            <span class="s2">&quot;check_shuffle_features_no_impact&quot;</span><span class="p">,</span>
            <span class="s2">&quot;check_emerging_features&quot;</span><span class="p">,</span>
            <span class="s2">&quot;check_disappearing_features&quot;</span><span class="p">,</span>
            <span class="s2">&quot;check_predict_proba_one&quot;</span><span class="p">,</span>
            <span class="s2">&quot;check_predict_proba_one_binary&quot;</span><span class="p">,</span>
        <span class="p">}</span>

    <span class="k">def</span> <span class="nf">learn_one</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Autoencoder&quot;</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Performs one step of training with a single example.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        x</span>
<span class="sd">            Input example.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Autoencoder</span>
<span class="sd">            The model itself.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">net</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_init_net</span><span class="p">(</span><span class="n">n_features</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">net</span><span class="o">.</span><span class="n">train</span><span class="p">()</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">dict2tensor</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_learn</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_learn</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">TensorType</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Autoencoder&quot;</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">net</span><span class="o">.</span><span class="n">train</span><span class="p">()</span>
        <span class="n">x_pred</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">net</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">loss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">loss_fn</span><span class="p">(</span><span class="n">x_pred</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
        <span class="n">loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">optimizer</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">optimizer</span><span class="o">.</span><span class="n">zero_grad</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">score_one</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns an anomaly score for the provided example in the form of the autoencoder&#39;s reconstruction error.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        x</span>
<span class="sd">            Input example.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        float</span>
<span class="sd">            Anomaly score for the given example. Larger values indicate more anomalous examples.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">net</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_init_net</span><span class="p">(</span><span class="n">n_features</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">dict2tensor</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">net</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
        <span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">inference_mode</span><span class="p">():</span>
            <span class="n">x_rec</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">net</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">loss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">loss_fn</span><span class="p">(</span><span class="n">x_rec</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">loss</span>

    <span class="k">def</span> <span class="nf">learn_many</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Autoencoder&quot;</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Performs one step of training with a batch of examples.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        x</span>
<span class="sd">            Input batch of examples.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Autoencoder</span>
<span class="sd">            The model itself.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">df2tensor</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_learn</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">score_many</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns an anomaly score for the provided batch of examples in the form of the autoencoder&#39;s reconstruction error.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        x</span>
<span class="sd">            Input batch of examples.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        float</span>
<span class="sd">            Anomaly scores for the given batch of examples. Larger values indicate more anomalous examples.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">net</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_init_net</span><span class="p">(</span><span class="n">n_features</span><span class="o">=</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">dict2tensor</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
        <span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">inference_mode</span><span class="p">():</span>
            <span class="n">x_rec</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">net</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">loss</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">loss_fn</span><span class="p">(</span><span class="n">x_rec</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">reduction</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">),</span>
            <span class="n">dim</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">dim</span><span class="p">())),</span>
        <span class="p">)</span>
        <span class="n">score</span> <span class="o">=</span> <span class="n">loss</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span><span class="o">.</span><span class="n">detach</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">score</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">










  <div class="doc doc-object doc-method">



<h4 id="river_torch.anomaly.base.Autoencoder.learn_many" class="doc doc-heading">
<code class="highlight language-python"><span class="n">learn_many</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span></code>


<a href="#river_torch.anomaly.base.Autoencoder.learn_many" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Performs one step of training with a batch of examples.</p>
<h6 id="river_torch.anomaly.base.Autoencoder.learn_many--parameters">Parameters<a class="headerlink" href="#river_torch.anomaly.base.Autoencoder.learn_many--parameters" title="Permanent link">&para;</a></h6>
<p>x
    Input batch of examples.</p>
<h6 id="river_torch.anomaly.base.Autoencoder.learn_many--returns">Returns<a class="headerlink" href="#river_torch.anomaly.base.Autoencoder.learn_many--returns" title="Permanent link">&para;</a></h6>
<p>Autoencoder
    The model itself.</p>

        <details class="quote">
          <summary>Source code in <code>river_torch/anomaly/base.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">learn_many</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Autoencoder&quot;</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Performs one step of training with a batch of examples.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    x</span>
<span class="sd">        Input batch of examples.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Autoencoder</span>
<span class="sd">        The model itself.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">df2tensor</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_learn</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="river_torch.anomaly.base.Autoencoder.learn_one" class="doc doc-heading">
<code class="highlight language-python"><span class="n">learn_one</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span></code>


<a href="#river_torch.anomaly.base.Autoencoder.learn_one" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Performs one step of training with a single example.</p>
<h6 id="river_torch.anomaly.base.Autoencoder.learn_one--parameters">Parameters<a class="headerlink" href="#river_torch.anomaly.base.Autoencoder.learn_one--parameters" title="Permanent link">&para;</a></h6>
<p>x
    Input example.</p>
<h6 id="river_torch.anomaly.base.Autoencoder.learn_one--returns">Returns<a class="headerlink" href="#river_torch.anomaly.base.Autoencoder.learn_one--returns" title="Permanent link">&para;</a></h6>
<p>Autoencoder
    The model itself.</p>

        <details class="quote">
          <summary>Source code in <code>river_torch/anomaly/base.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">learn_one</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Autoencoder&quot;</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Performs one step of training with a single example.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    x</span>
<span class="sd">        Input example.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Autoencoder</span>
<span class="sd">        The model itself.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">net</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_init_net</span><span class="p">(</span><span class="n">n_features</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">net</span><span class="o">.</span><span class="n">train</span><span class="p">()</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">dict2tensor</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_learn</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="river_torch.anomaly.base.Autoencoder.score_many" class="doc doc-heading">
<code class="highlight language-python"><span class="n">score_many</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span></code>


<a href="#river_torch.anomaly.base.Autoencoder.score_many" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Returns an anomaly score for the provided batch of examples in the form of the autoencoder's reconstruction error.</p>
<h6 id="river_torch.anomaly.base.Autoencoder.score_many--parameters">Parameters<a class="headerlink" href="#river_torch.anomaly.base.Autoencoder.score_many--parameters" title="Permanent link">&para;</a></h6>
<p>x
    Input batch of examples.</p>
<h6 id="river_torch.anomaly.base.Autoencoder.score_many--returns">Returns<a class="headerlink" href="#river_torch.anomaly.base.Autoencoder.score_many--returns" title="Permanent link">&para;</a></h6>
<p>float
    Anomaly scores for the given batch of examples. Larger values indicate more anomalous examples.</p>

        <details class="quote">
          <summary>Source code in <code>river_torch/anomaly/base.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">score_many</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns an anomaly score for the provided batch of examples in the form of the autoencoder&#39;s reconstruction error.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    x</span>
<span class="sd">        Input batch of examples.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    float</span>
<span class="sd">        Anomaly scores for the given batch of examples. Larger values indicate more anomalous examples.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">net</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_init_net</span><span class="p">(</span><span class="n">n_features</span><span class="o">=</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">dict2tensor</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
    <span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">inference_mode</span><span class="p">():</span>
        <span class="n">x_rec</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">net</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">loss</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">loss_fn</span><span class="p">(</span><span class="n">x_rec</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">reduction</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">),</span>
        <span class="n">dim</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">dim</span><span class="p">())),</span>
    <span class="p">)</span>
    <span class="n">score</span> <span class="o">=</span> <span class="n">loss</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span><span class="o">.</span><span class="n">detach</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">score</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="river_torch.anomaly.base.Autoencoder.score_one" class="doc doc-heading">
<code class="highlight language-python"><span class="n">score_one</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span></code>


<a href="#river_torch.anomaly.base.Autoencoder.score_one" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Returns an anomaly score for the provided example in the form of the autoencoder's reconstruction error.</p>
<h6 id="river_torch.anomaly.base.Autoencoder.score_one--parameters">Parameters<a class="headerlink" href="#river_torch.anomaly.base.Autoencoder.score_one--parameters" title="Permanent link">&para;</a></h6>
<p>x
    Input example.</p>
<h6 id="river_torch.anomaly.base.Autoencoder.score_one--returns">Returns<a class="headerlink" href="#river_torch.anomaly.base.Autoencoder.score_one--returns" title="Permanent link">&para;</a></h6>
<p>float
    Anomaly score for the given example. Larger values indicate more anomalous examples.</p>

        <details class="quote">
          <summary>Source code in <code>river_torch/anomaly/base.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">score_one</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns an anomaly score for the provided example in the form of the autoencoder&#39;s reconstruction error.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    x</span>
<span class="sd">        Input example.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    float</span>
<span class="sd">        Anomaly score for the given example. Larger values indicate more anomalous examples.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">net</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_init_net</span><span class="p">(</span><span class="n">n_features</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">dict2tensor</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">net</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
    <span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">inference_mode</span><span class="p">():</span>
        <span class="n">x_rec</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">net</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">loss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">loss_fn</span><span class="p">(</span><span class="n">x_rec</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">loss</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>







  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h2 id="river_torch.anomaly.probability_weighted_ae" class="doc doc-heading">
        <code>probability_weighted_ae</code>



<a href="#river_torch.anomaly.probability_weighted_ae" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">




  <div class="doc doc-children">







  <div class="doc doc-object doc-class">



<h3 id="river_torch.anomaly.probability_weighted_ae.ProbabilityWeightedAutoencoder" class="doc doc-heading">
        <code>
ProbabilityWeightedAutoencoder            (<a class="autorefs autorefs-internal" title="river_torch.anomaly.base.Autoencoder" href="#river_torch.anomaly.base.Autoencoder">Autoencoder</a>)
        </code>



<a href="#river_torch.anomaly.probability_weighted_ae.ProbabilityWeightedAutoencoder" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Wrapper for PyTorch autoencoder models for anomaly detection that reduces the employed learning rate based on an outlier probability estimate of the input example as well as a threshold probability <code>skip_threshold</code>. If the outlier probability is above the threshold, the learning rate is reduced to less than 0. Given the probability estimate <span class="arithmatex">\(p_out\)</span>, the adjusted learning rate <span class="arithmatex">\(lr_adj\)</span> is <span class="arithmatex">\(lr * 1 - (rac{p_out}{skip_threshold})\)</span>.</p>
<h5 id="river_torch.anomaly.probability_weighted_ae.ProbabilityWeightedAutoencoder--parameters">Parameters<a class="headerlink" href="#river_torch.anomaly.probability_weighted_ae.ProbabilityWeightedAutoencoder--parameters" title="Permanent link">&para;</a></h5>
<p>build_fn
    Function that builds the autoencoder to be wrapped. The function should accept parameter <code>n_features</code> so that the returned model's input shape can be determined based on the number of features in the initial training example.
loss_fn
    Loss function to be used for training the wrapped model. Can be a loss function provided by <code>torch.nn.functional</code> or one of the following: 'mse', 'l1', 'cross_entropy', 'binary_crossentropy', 'smooth_l1', 'kl_div'.
optimizer_fn
    Optimizer to be used for training the wrapped model. Can be an optimizer class provided by <code>torch.optim</code> or one of the following: "adam", "adam_w", "sgd", "rmsprop", "lbfgs".
lr
    Base learning rate of the optimizer.
skip_threshold
    Threshold probability to use as a reference for the reduction of the base learning rate.
device
    Device to run the wrapped model on. Can be "cpu" or "cuda".
seed
    Random seed to be used for training the wrapped model.
**net_params
    Parameters to be passed to the <code>build_fn</code> function aside from <code>n_features</code>.</p>

        <details class="quote">
          <summary>Source code in <code>river_torch/anomaly/probability_weighted_ae.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">ProbabilityWeightedAutoencoder</span><span class="p">(</span><span class="n">base</span><span class="o">.</span><span class="n">Autoencoder</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Wrapper for PyTorch autoencoder models for anomaly detection that reduces the employed learning rate based on an outlier probability estimate of the input example as well as a threshold probability `skip_threshold`. If the outlier probability is above the threshold, the learning rate is reduced to less than 0. Given the probability estimate $p_out$, the adjusted learning rate $lr_adj$ is $lr * 1 - (\frac{p_out}{skip_threshold})$.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    build_fn</span>
<span class="sd">        Function that builds the autoencoder to be wrapped. The function should accept parameter `n_features` so that the returned model&#39;s input shape can be determined based on the number of features in the initial training example.</span>
<span class="sd">    loss_fn</span>
<span class="sd">        Loss function to be used for training the wrapped model. Can be a loss function provided by `torch.nn.functional` or one of the following: &#39;mse&#39;, &#39;l1&#39;, &#39;cross_entropy&#39;, &#39;binary_crossentropy&#39;, &#39;smooth_l1&#39;, &#39;kl_div&#39;.</span>
<span class="sd">    optimizer_fn</span>
<span class="sd">        Optimizer to be used for training the wrapped model. Can be an optimizer class provided by `torch.optim` or one of the following: &quot;adam&quot;, &quot;adam_w&quot;, &quot;sgd&quot;, &quot;rmsprop&quot;, &quot;lbfgs&quot;.</span>
<span class="sd">    lr</span>
<span class="sd">        Base learning rate of the optimizer.</span>
<span class="sd">    skip_threshold</span>
<span class="sd">        Threshold probability to use as a reference for the reduction of the base learning rate.</span>
<span class="sd">    device</span>
<span class="sd">        Device to run the wrapped model on. Can be &quot;cpu&quot; or &quot;cuda&quot;.</span>
<span class="sd">    seed</span>
<span class="sd">        Random seed to be used for training the wrapped model.</span>
<span class="sd">    **net_params</span>
<span class="sd">        Parameters to be passed to the `build_fn` function aside from `n_features`.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">build_fn</span><span class="p">:</span> <span class="n">Callable</span><span class="p">,</span>
        <span class="n">loss_fn</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Callable</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;mse&quot;</span><span class="p">,</span>
        <span class="n">optimizer_fn</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Callable</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;sgd&quot;</span><span class="p">,</span>
        <span class="n">lr</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-3</span><span class="p">,</span>
        <span class="n">device</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;cpu&quot;</span><span class="p">,</span>
        <span class="n">seed</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">42</span><span class="p">,</span>
        <span class="n">skip_threshold</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.9</span><span class="p">,</span>
        <span class="o">**</span><span class="n">net_params</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">build_fn</span><span class="o">=</span><span class="n">build_fn</span><span class="p">,</span>
            <span class="n">loss_fn</span><span class="o">=</span><span class="n">loss_fn</span><span class="p">,</span>
            <span class="n">optimizer_fn</span><span class="o">=</span><span class="n">optimizer_fn</span><span class="p">,</span>
            <span class="n">lr</span><span class="o">=</span><span class="n">lr</span><span class="p">,</span>
            <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">,</span>
            <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">,</span>
            <span class="o">**</span><span class="n">net_params</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">skip_threshold</span> <span class="o">=</span> <span class="n">skip_threshold</span>

    <span class="k">def</span> <span class="nf">learn_one</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;ProbabilityWeightedAutoencoder&quot;</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Performs one step of training with a single example, scaling the employed learning rate based on the outlier probability estimate of the input example.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        x</span>
<span class="sd">            Input example.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        ProbabilityWeightedAutoencoder</span>
<span class="sd">            The autoencoder itself.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_init</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_init_net</span><span class="p">(</span><span class="n">n_features</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">dict2tensor</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">net</span><span class="o">.</span><span class="n">train</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_learn_one</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_learn_one</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">x_pred</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">net</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">loss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">loss_fn</span><span class="p">(</span><span class="n">x_pred</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
        <span class="n">loss_item</span> <span class="o">=</span> <span class="n">loss</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
        <span class="n">mean</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean_meter</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="n">std</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">var_meter</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">var_meter</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mean_meter</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">loss_item</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">var_meter</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">loss_item</span><span class="p">)</span>

        <span class="n">loss_scaled</span> <span class="o">=</span> <span class="p">(</span><span class="n">loss_item</span> <span class="o">-</span> <span class="n">mean</span><span class="p">)</span> <span class="o">/</span> <span class="n">std</span>
        <span class="n">prob</span> <span class="o">=</span> <span class="n">ndtr</span><span class="p">(</span><span class="n">loss_scaled</span><span class="p">)</span>
        <span class="n">loss</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">skip_threshold</span> <span class="o">-</span> <span class="n">prob</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">skip_threshold</span> <span class="o">*</span> <span class="n">loss</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">optimizer</span><span class="o">.</span><span class="n">zero_grad</span><span class="p">()</span>
        <span class="n">loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">optimizer</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">










  <div class="doc doc-object doc-method">



<h4 id="river_torch.anomaly.probability_weighted_ae.ProbabilityWeightedAutoencoder.learn_one" class="doc doc-heading">
<code class="highlight language-python"><span class="n">learn_one</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span></code>


<a href="#river_torch.anomaly.probability_weighted_ae.ProbabilityWeightedAutoencoder.learn_one" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Performs one step of training with a single example, scaling the employed learning rate based on the outlier probability estimate of the input example.</p>
<h6 id="river_torch.anomaly.probability_weighted_ae.ProbabilityWeightedAutoencoder.learn_one--parameters">Parameters<a class="headerlink" href="#river_torch.anomaly.probability_weighted_ae.ProbabilityWeightedAutoencoder.learn_one--parameters" title="Permanent link">&para;</a></h6>
<p>x
    Input example.</p>
<h6 id="river_torch.anomaly.probability_weighted_ae.ProbabilityWeightedAutoencoder.learn_one--returns">Returns<a class="headerlink" href="#river_torch.anomaly.probability_weighted_ae.ProbabilityWeightedAutoencoder.learn_one--returns" title="Permanent link">&para;</a></h6>
<p>ProbabilityWeightedAutoencoder
    The autoencoder itself.</p>

        <details class="quote">
          <summary>Source code in <code>river_torch/anomaly/probability_weighted_ae.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">learn_one</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;ProbabilityWeightedAutoencoder&quot;</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Performs one step of training with a single example, scaling the employed learning rate based on the outlier probability estimate of the input example.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    x</span>
<span class="sd">        Input example.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    ProbabilityWeightedAutoencoder</span>
<span class="sd">        The autoencoder itself.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_init</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_init_net</span><span class="p">(</span><span class="n">n_features</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">dict2tensor</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">net</span><span class="o">.</span><span class="n">train</span><span class="p">()</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_learn_one</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>







  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h2 id="river_torch.anomaly.rolling_ae" class="doc doc-heading">
        <code>rolling_ae</code>



<a href="#river_torch.anomaly.rolling_ae" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">




  <div class="doc doc-children">







  <div class="doc doc-object doc-class">



<h3 id="river_torch.anomaly.rolling_ae.RollingAutoencoder" class="doc doc-heading">
        <code>
RollingAutoencoder            (<a class="autorefs autorefs-internal" title="river_torch.anomaly.base.Autoencoder" href="#river_torch.anomaly.base.Autoencoder">Autoencoder</a>)
        </code>



<a href="#river_torch.anomaly.rolling_ae.RollingAutoencoder" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Wrapper for PyTorch autoencoder models that uses the networks reconstruction error for scoring the anomalousness of a given example. The class also features a rolling window to allow the model to make predictions based on the reconstructability of multiple previous examples.</p>
<h5 id="river_torch.anomaly.rolling_ae.RollingAutoencoder--parameters">Parameters<a class="headerlink" href="#river_torch.anomaly.rolling_ae.RollingAutoencoder--parameters" title="Permanent link">&para;</a></h5>
<p>build_fn
    Function that builds the autoencoder to be wrapped. The function should accept parameter <code>n_features</code> so that the returned model's input shape can be determined based on the number of features in the initial training example.
loss_fn
    Loss function to be used for training the wrapped model. Can be a loss function provided by <code>torch.nn.functional</code> or one of the following: 'mse', 'l1', 'cross_entropy', 'binary_crossentropy', 'smooth_l1', 'kl_div'.
optimizer_fn
    Optimizer to be used for training the wrapped model. Can be an optimizer class provided by <code>torch.optim</code> or one of the following: "adam", "adam_w", "sgd", "rmsprop", "lbfgs".
lr
    Learning rate of the optimizer.
device
    Device to run the wrapped model on. Can be "cpu" or "cuda".
seed
    Random seed to be used for training the wrapped model.
window_size
    Size of the rolling window used for storing previous examples.
append_predict
    Whether to append inputs passed for prediction to the rolling window.
**net_params
    Parameters to be passed to the <code>build_fn</code> function aside from <code>n_features</code>.</p>

        <details class="quote">
          <summary>Source code in <code>river_torch/anomaly/rolling_ae.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">RollingAutoencoder</span><span class="p">(</span><span class="n">base</span><span class="o">.</span><span class="n">Autoencoder</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Wrapper for PyTorch autoencoder models that uses the networks reconstruction error for scoring the anomalousness of a given example. The class also features a rolling window to allow the model to make predictions based on the reconstructability of multiple previous examples.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    build_fn</span>
<span class="sd">        Function that builds the autoencoder to be wrapped. The function should accept parameter `n_features` so that the returned model&#39;s input shape can be determined based on the number of features in the initial training example.</span>
<span class="sd">    loss_fn</span>
<span class="sd">        Loss function to be used for training the wrapped model. Can be a loss function provided by `torch.nn.functional` or one of the following: &#39;mse&#39;, &#39;l1&#39;, &#39;cross_entropy&#39;, &#39;binary_crossentropy&#39;, &#39;smooth_l1&#39;, &#39;kl_div&#39;.</span>
<span class="sd">    optimizer_fn</span>
<span class="sd">        Optimizer to be used for training the wrapped model. Can be an optimizer class provided by `torch.optim` or one of the following: &quot;adam&quot;, &quot;adam_w&quot;, &quot;sgd&quot;, &quot;rmsprop&quot;, &quot;lbfgs&quot;.</span>
<span class="sd">    lr</span>
<span class="sd">        Learning rate of the optimizer.</span>
<span class="sd">    device</span>
<span class="sd">        Device to run the wrapped model on. Can be &quot;cpu&quot; or &quot;cuda&quot;.</span>
<span class="sd">    seed</span>
<span class="sd">        Random seed to be used for training the wrapped model.</span>
<span class="sd">    window_size</span>
<span class="sd">        Size of the rolling window used for storing previous examples.</span>
<span class="sd">    append_predict</span>
<span class="sd">        Whether to append inputs passed for prediction to the rolling window.</span>
<span class="sd">    **net_params</span>
<span class="sd">        Parameters to be passed to the `build_fn` function aside from `n_features`.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">build_fn</span><span class="p">:</span> <span class="n">Callable</span><span class="p">,</span>
        <span class="n">loss_fn</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Callable</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;mse&quot;</span><span class="p">,</span>
        <span class="n">optimizer_fn</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Callable</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;sgd&quot;</span><span class="p">,</span>
        <span class="n">lr</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-3</span><span class="p">,</span>
        <span class="n">device</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;cpu&quot;</span><span class="p">,</span>
        <span class="n">seed</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">42</span><span class="p">,</span>
        <span class="n">window_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
        <span class="n">append_predict</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="o">**</span><span class="n">net_params</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">build_fn</span><span class="o">=</span><span class="n">build_fn</span><span class="p">,</span>
            <span class="n">loss_fn</span><span class="o">=</span><span class="n">loss_fn</span><span class="p">,</span>
            <span class="n">optimizer_fn</span><span class="o">=</span><span class="n">optimizer_fn</span><span class="p">,</span>
            <span class="n">lr</span><span class="o">=</span><span class="n">lr</span><span class="p">,</span>
            <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">,</span>
            <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">,</span>
            <span class="o">**</span><span class="n">net_params</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">append_predict</span> <span class="o">=</span> <span class="n">append_predict</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">window_size</span> <span class="o">=</span> <span class="n">window_size</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_x_window</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">deque</span><span class="p">(</span><span class="n">maxlen</span><span class="o">=</span><span class="n">window_size</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_batch_i</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">def</span> <span class="nf">_learn_window</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">net</span><span class="o">.</span><span class="n">train</span><span class="p">()</span>

        <span class="n">x_pred</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">net</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">loss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">loss_fn</span><span class="p">(</span><span class="n">x_pred</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">optimizer</span><span class="o">.</span><span class="n">zero_grad</span><span class="p">()</span>
        <span class="n">loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">optimizer</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">learn_one</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;RollingAutoencoder&quot;</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Performs one step of training with a single example.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        x</span>
<span class="sd">            Input example.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        RollingAutoencoder</span>
<span class="sd">            The estimator itself.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">net</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_init_net</span><span class="p">(</span><span class="n">n_features</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_x_window</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_x_window</span><span class="p">)</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_size</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">net</span><span class="o">.</span><span class="n">train</span><span class="p">()</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">list2tensor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_x_window</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_learn_window</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">score_one</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">net</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_init_net</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">append_predict</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_x_window</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>
            <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_x_window</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_x_window</span><span class="p">)</span>
            <span class="n">x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_x_window</span><span class="p">)</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_size</span><span class="p">:</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">list2tensor</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">net</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
            <span class="n">x_pred</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">net</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
            <span class="n">loss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">loss_fn</span><span class="p">(</span><span class="n">x_pred</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">loss</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mf">0.0</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">










  <div class="doc doc-object doc-method">



<h4 id="river_torch.anomaly.rolling_ae.RollingAutoencoder.learn_one" class="doc doc-heading">
<code class="highlight language-python"><span class="n">learn_one</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span></code>


<a href="#river_torch.anomaly.rolling_ae.RollingAutoencoder.learn_one" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Performs one step of training with a single example.</p>
<h6 id="river_torch.anomaly.rolling_ae.RollingAutoencoder.learn_one--parameters">Parameters<a class="headerlink" href="#river_torch.anomaly.rolling_ae.RollingAutoencoder.learn_one--parameters" title="Permanent link">&para;</a></h6>
<p>x
    Input example.</p>
<h6 id="river_torch.anomaly.rolling_ae.RollingAutoencoder.learn_one--returns">Returns<a class="headerlink" href="#river_torch.anomaly.rolling_ae.RollingAutoencoder.learn_one--returns" title="Permanent link">&para;</a></h6>
<p>RollingAutoencoder
    The estimator itself.</p>

        <details class="quote">
          <summary>Source code in <code>river_torch/anomaly/rolling_ae.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">learn_one</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;RollingAutoencoder&quot;</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Performs one step of training with a single example.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    x</span>
<span class="sd">        Input example.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    RollingAutoencoder</span>
<span class="sd">        The estimator itself.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">net</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_init_net</span><span class="p">(</span><span class="n">n_features</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_x_window</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_x_window</span><span class="p">)</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_size</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">net</span><span class="o">.</span><span class="n">train</span><span class="p">()</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">list2tensor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_x_window</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_learn_window</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="river_torch.anomaly.rolling_ae.RollingAutoencoder.score_one" class="doc doc-heading">
<code class="highlight language-python"><span class="n">score_one</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span></code>


<a href="#river_torch.anomaly.rolling_ae.RollingAutoencoder.score_one" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Returns an anomaly score for the provided example in the form of the autoencoder's reconstruction error.</p>
<h6 id="river_torch.anomaly.rolling_ae.RollingAutoencoder.score_one--parameters">Parameters<a class="headerlink" href="#river_torch.anomaly.rolling_ae.RollingAutoencoder.score_one--parameters" title="Permanent link">&para;</a></h6>
<p>x
    Input example.</p>
<h6 id="river_torch.anomaly.rolling_ae.RollingAutoencoder.score_one--returns">Returns<a class="headerlink" href="#river_torch.anomaly.rolling_ae.RollingAutoencoder.score_one--returns" title="Permanent link">&para;</a></h6>
<p>float
    Anomaly score for the given example. Larger values indicate more anomalous examples.</p>

        <details class="quote">
          <summary>Source code in <code>river_torch/anomaly/rolling_ae.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">score_one</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">net</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_init_net</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">append_predict</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_x_window</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_x_window</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_x_window</span><span class="p">)</span>
        <span class="n">x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_x_window</span><span class="p">)</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_size</span><span class="p">:</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">list2tensor</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">net</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
        <span class="n">x_pred</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">net</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">loss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">loss_fn</span><span class="p">(</span><span class="n">x_pred</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">loss</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="mf">0.0</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>







  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h2 id="river_torch.anomaly.scaler" class="doc doc-heading">
        <code>scaler</code>



<a href="#river_torch.anomaly.scaler" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">




  <div class="doc doc-children">








  <div class="doc doc-object doc-class">



<h3 id="river_torch.anomaly.scaler.MeanScaler" class="doc doc-heading">
        <code>
MeanScaler            (<a class="autorefs autorefs-internal" title="river_torch.anomaly.base.AnomalyScaler" href="#river_torch.anomaly.base.AnomalyScaler">AnomalyScaler</a>)
        </code>



<a href="#river_torch.anomaly.scaler.MeanScaler" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Wrapper around an anomaly detector that scales the model's output by the incremental mean of previous scores.</p>
<h5 id="river_torch.anomaly.scaler.MeanScaler--parameters">Parameters<a class="headerlink" href="#river_torch.anomaly.scaler.MeanScaler--parameters" title="Permanent link">&para;</a></h5>
<p>anomaly_detector
    The anomaly detector to wrap.
metric_type
    The type of metric to use.
window_size
    The window size used for mean computation if metric_type=="rolling".
alpha
    The alpha used for mean computation if metric_type=="adaptive".</p>

        <details class="quote">
          <summary>Source code in <code>river_torch/anomaly/scaler.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">MeanScaler</span><span class="p">(</span><span class="n">AnomalyScaler</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Wrapper around an anomaly detector that scales the model&#39;s output by the incremental mean of previous scores.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    anomaly_detector</span>
<span class="sd">        The anomaly detector to wrap.</span>
<span class="sd">    metric_type</span>
<span class="sd">        The type of metric to use.</span>
<span class="sd">    window_size</span>
<span class="sd">        The window size used for mean computation if metric_type==&quot;rolling&quot;.</span>
<span class="sd">    alpha</span>
<span class="sd">        The alpha used for mean computation if metric_type==&quot;adaptive&quot;.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">anomaly_detector</span><span class="p">:</span> <span class="n">AnomalyDetector</span><span class="p">,</span>
        <span class="n">metric_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;rolling&quot;</span><span class="p">,</span>
        <span class="n">window_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">250</span><span class="p">,</span>
        <span class="n">alpha</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">anomaly_detector</span><span class="o">=</span><span class="n">anomaly_detector</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">metric_type</span> <span class="o">=</span> <span class="n">metric_type</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span> <span class="o">=</span> <span class="n">alpha</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">window_size</span> <span class="o">=</span> <span class="n">window_size</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mean</span> <span class="o">=</span> <span class="n">_get_metric</span><span class="p">(</span><span class="s2">&quot;mean&quot;</span><span class="p">,</span> <span class="n">metric_type</span><span class="p">,</span> <span class="n">window_size</span><span class="p">,</span> <span class="n">alpha</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">score_one</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a scaled anomaly score based on raw score provided by the wrapped anomaly detector. Larger values indicate more anomalous examples.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        *args</span>
<span class="sd">            Depends on whether the underlying anomaly detector is supervised or not.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        An scaled anomaly score. Larger values indicate more anomalous examples.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">raw_score</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">anomaly_detector</span><span class="o">.</span><span class="n">score_one</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
        <span class="n">mean</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">raw_score</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="n">score</span> <span class="o">=</span> <span class="n">raw_score</span> <span class="o">/</span> <span class="n">mean</span>

        <span class="k">return</span> <span class="n">score</span>

    <span class="k">def</span> <span class="nf">score_many</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return scaled anomaly scores based on raw scores provided by the wrapped anomaly detector. Larger values indicate more anomalous examples.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        *args</span>
<span class="sd">            Depends on whether the underlying anomaly detector is supervised or not.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        An scaled anomaly score. Larger values indicate more anomalous examples.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">raw_score</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">anomaly_detector</span><span class="o">.</span><span class="n">score_many</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
        <span class="n">mean</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="o">.</span><span class="n">update_many</span><span class="p">(</span><span class="n">raw_score</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="n">score</span> <span class="o">=</span> <span class="n">raw_score</span> <span class="o">/</span> <span class="n">mean</span>

        <span class="k">return</span> <span class="n">score</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">










  <div class="doc doc-object doc-method">



<h4 id="river_torch.anomaly.scaler.MeanScaler.score_many" class="doc doc-heading">
<code class="highlight language-python"><span class="n">score_many</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span></code>


<a href="#river_torch.anomaly.scaler.MeanScaler.score_many" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Return scaled anomaly scores based on raw scores provided by the wrapped anomaly detector. Larger values indicate more anomalous examples.</p>
<h6 id="river_torch.anomaly.scaler.MeanScaler.score_many--parameters">Parameters<a class="headerlink" href="#river_torch.anomaly.scaler.MeanScaler.score_many--parameters" title="Permanent link">&para;</a></h6>
<p>*args
    Depends on whether the underlying anomaly detector is supervised or not.</p>
<h6 id="river_torch.anomaly.scaler.MeanScaler.score_many--returns">Returns<a class="headerlink" href="#river_torch.anomaly.scaler.MeanScaler.score_many--returns" title="Permanent link">&para;</a></h6>
<p>An scaled anomaly score. Larger values indicate more anomalous examples.</p>

        <details class="quote">
          <summary>Source code in <code>river_torch/anomaly/scaler.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">score_many</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return scaled anomaly scores based on raw scores provided by the wrapped anomaly detector. Larger values indicate more anomalous examples.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    *args</span>
<span class="sd">        Depends on whether the underlying anomaly detector is supervised or not.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    An scaled anomaly score. Larger values indicate more anomalous examples.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">raw_score</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">anomaly_detector</span><span class="o">.</span><span class="n">score_many</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
    <span class="n">mean</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="o">.</span><span class="n">update_many</span><span class="p">(</span><span class="n">raw_score</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
    <span class="n">score</span> <span class="o">=</span> <span class="n">raw_score</span> <span class="o">/</span> <span class="n">mean</span>

    <span class="k">return</span> <span class="n">score</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="river_torch.anomaly.scaler.MeanScaler.score_one" class="doc doc-heading">
<code class="highlight language-python"><span class="n">score_one</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span></code>


<a href="#river_torch.anomaly.scaler.MeanScaler.score_one" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Return a scaled anomaly score based on raw score provided by the wrapped anomaly detector. Larger values indicate more anomalous examples.</p>
<h6 id="river_torch.anomaly.scaler.MeanScaler.score_one--parameters">Parameters<a class="headerlink" href="#river_torch.anomaly.scaler.MeanScaler.score_one--parameters" title="Permanent link">&para;</a></h6>
<p>*args
    Depends on whether the underlying anomaly detector is supervised or not.</p>
<h6 id="river_torch.anomaly.scaler.MeanScaler.score_one--returns">Returns<a class="headerlink" href="#river_torch.anomaly.scaler.MeanScaler.score_one--returns" title="Permanent link">&para;</a></h6>
<p>An scaled anomaly score. Larger values indicate more anomalous examples.</p>

        <details class="quote">
          <summary>Source code in <code>river_torch/anomaly/scaler.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">score_one</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return a scaled anomaly score based on raw score provided by the wrapped anomaly detector. Larger values indicate more anomalous examples.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    *args</span>
<span class="sd">        Depends on whether the underlying anomaly detector is supervised or not.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    An scaled anomaly score. Larger values indicate more anomalous examples.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">raw_score</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">anomaly_detector</span><span class="o">.</span><span class="n">score_one</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
    <span class="n">mean</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">raw_score</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
    <span class="n">score</span> <span class="o">=</span> <span class="n">raw_score</span> <span class="o">/</span> <span class="n">mean</span>

    <span class="k">return</span> <span class="n">score</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h3 id="river_torch.anomaly.scaler.MinMaxScaler" class="doc doc-heading">
        <code>
MinMaxScaler            (<a class="autorefs autorefs-internal" title="river_torch.anomaly.base.AnomalyScaler" href="#river_torch.anomaly.base.AnomalyScaler">AnomalyScaler</a>)
        </code>



<a href="#river_torch.anomaly.scaler.MinMaxScaler" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Wrapper around an anomaly detector that scales the model's output to <span class="arithmatex">\([0, 1]\)</span> using rolling min and max metrics.</p>
<h5 id="river_torch.anomaly.scaler.MinMaxScaler--parameters">Parameters<a class="headerlink" href="#river_torch.anomaly.scaler.MinMaxScaler--parameters" title="Permanent link">&para;</a></h5>
<p>anomaly_detector
    The anomaly detector to wrap.
metric_type
    The type of metric to use.
window_size
    The window size used for the metrics if metric_type=="rolling".
alpha
    The alpha used for the metrics if metric_type=="adaptive".</p>

        <details class="quote">
          <summary>Source code in <code>river_torch/anomaly/scaler.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">MinMaxScaler</span><span class="p">(</span><span class="n">AnomalyScaler</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Wrapper around an anomaly detector that scales the model&#39;s output to $[0, 1]$ using rolling min and max metrics.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    anomaly_detector</span>
<span class="sd">        The anomaly detector to wrap.</span>
<span class="sd">    metric_type</span>
<span class="sd">        The type of metric to use.</span>
<span class="sd">    window_size</span>
<span class="sd">        The window size used for the metrics if metric_type==&quot;rolling&quot;.</span>
<span class="sd">    alpha</span>
<span class="sd">        The alpha used for the metrics if metric_type==&quot;adaptive&quot;.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">anomaly_detector</span><span class="p">:</span> <span class="n">AnomalyDetector</span><span class="p">,</span>
        <span class="n">metric_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;rolling&quot;</span><span class="p">,</span>
        <span class="n">window_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">250</span><span class="p">,</span>
        <span class="n">alpha</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">anomaly_detector</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">metric_type</span> <span class="o">=</span> <span class="n">metric_type</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span> <span class="o">=</span> <span class="n">alpha</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">window_size</span> <span class="o">=</span> <span class="n">window_size</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">min</span> <span class="o">=</span> <span class="n">_get_metric</span><span class="p">(</span><span class="s2">&quot;min&quot;</span><span class="p">,</span> <span class="n">metric_type</span><span class="p">,</span> <span class="n">window_size</span><span class="p">,</span> <span class="n">alpha</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max</span> <span class="o">=</span> <span class="n">_get_metric</span><span class="p">(</span><span class="s2">&quot;max&quot;</span><span class="p">,</span> <span class="n">metric_type</span><span class="p">,</span> <span class="n">window_size</span><span class="p">,</span> <span class="n">alpha</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">score_one</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a scaled anomaly score based on raw score provided by the wrapped anomaly detector. Larger values indicate more anomalous examples.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        *args</span>
<span class="sd">            Depends on whether the underlying anomaly detector is supervised or not.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        An scaled anomaly score. Larger values indicate more anomalous examples.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">raw_score</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">anomaly_detector</span><span class="o">.</span><span class="n">score_one</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
        <span class="nb">min</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">min</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">raw_score</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="nb">max</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">max</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">raw_score</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="n">score</span> <span class="o">=</span> <span class="p">(</span><span class="n">raw_score</span> <span class="o">-</span> <span class="nb">min</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="nb">max</span> <span class="o">-</span> <span class="nb">min</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">score</span>

    <span class="k">def</span> <span class="nf">score_many</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return scaled anomaly scores based on raw scores provided by the wrapped anomaly detector. Larger values indicate more anomalous examples.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        *args</span>
<span class="sd">            Depends on whether the underlying anomaly detector is supervised or not.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        An scaled anomaly score. Larger values indicate more anomalous examples.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">raw_scores</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">anomaly_detector</span><span class="o">.</span><span class="n">score_many</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">raw_score</span> <span class="ow">in</span> <span class="n">raw_scores</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">min</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">raw_score</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">max</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">raw_score</span><span class="p">)</span>

        <span class="nb">min</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">min</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="nb">max</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">max</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="n">score</span> <span class="o">=</span> <span class="p">(</span><span class="n">raw_score</span> <span class="o">-</span> <span class="nb">min</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="nb">max</span> <span class="o">-</span> <span class="nb">min</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">score</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">










  <div class="doc doc-object doc-method">



<h4 id="river_torch.anomaly.scaler.MinMaxScaler.score_many" class="doc doc-heading">
<code class="highlight language-python"><span class="n">score_many</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span></code>


<a href="#river_torch.anomaly.scaler.MinMaxScaler.score_many" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Return scaled anomaly scores based on raw scores provided by the wrapped anomaly detector. Larger values indicate more anomalous examples.</p>
<h6 id="river_torch.anomaly.scaler.MinMaxScaler.score_many--parameters">Parameters<a class="headerlink" href="#river_torch.anomaly.scaler.MinMaxScaler.score_many--parameters" title="Permanent link">&para;</a></h6>
<p>*args
    Depends on whether the underlying anomaly detector is supervised or not.</p>
<h6 id="river_torch.anomaly.scaler.MinMaxScaler.score_many--returns">Returns<a class="headerlink" href="#river_torch.anomaly.scaler.MinMaxScaler.score_many--returns" title="Permanent link">&para;</a></h6>
<p>An scaled anomaly score. Larger values indicate more anomalous examples.</p>

        <details class="quote">
          <summary>Source code in <code>river_torch/anomaly/scaler.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">score_many</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return scaled anomaly scores based on raw scores provided by the wrapped anomaly detector. Larger values indicate more anomalous examples.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    *args</span>
<span class="sd">        Depends on whether the underlying anomaly detector is supervised or not.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    An scaled anomaly score. Larger values indicate more anomalous examples.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">raw_scores</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">anomaly_detector</span><span class="o">.</span><span class="n">score_many</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">raw_score</span> <span class="ow">in</span> <span class="n">raw_scores</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">min</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">raw_score</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">raw_score</span><span class="p">)</span>

    <span class="nb">min</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">min</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
    <span class="nb">max</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">max</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
    <span class="n">score</span> <span class="o">=</span> <span class="p">(</span><span class="n">raw_score</span> <span class="o">-</span> <span class="nb">min</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="nb">max</span> <span class="o">-</span> <span class="nb">min</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">score</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="river_torch.anomaly.scaler.MinMaxScaler.score_one" class="doc doc-heading">
<code class="highlight language-python"><span class="n">score_one</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span></code>


<a href="#river_torch.anomaly.scaler.MinMaxScaler.score_one" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Return a scaled anomaly score based on raw score provided by the wrapped anomaly detector. Larger values indicate more anomalous examples.</p>
<h6 id="river_torch.anomaly.scaler.MinMaxScaler.score_one--parameters">Parameters<a class="headerlink" href="#river_torch.anomaly.scaler.MinMaxScaler.score_one--parameters" title="Permanent link">&para;</a></h6>
<p>*args
    Depends on whether the underlying anomaly detector is supervised or not.</p>
<h6 id="river_torch.anomaly.scaler.MinMaxScaler.score_one--returns">Returns<a class="headerlink" href="#river_torch.anomaly.scaler.MinMaxScaler.score_one--returns" title="Permanent link">&para;</a></h6>
<p>An scaled anomaly score. Larger values indicate more anomalous examples.</p>

        <details class="quote">
          <summary>Source code in <code>river_torch/anomaly/scaler.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">score_one</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return a scaled anomaly score based on raw score provided by the wrapped anomaly detector. Larger values indicate more anomalous examples.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    *args</span>
<span class="sd">        Depends on whether the underlying anomaly detector is supervised or not.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    An scaled anomaly score. Larger values indicate more anomalous examples.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">raw_score</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">anomaly_detector</span><span class="o">.</span><span class="n">score_one</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
    <span class="nb">min</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">min</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">raw_score</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
    <span class="nb">max</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">max</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">raw_score</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
    <span class="n">score</span> <span class="o">=</span> <span class="p">(</span><span class="n">raw_score</span> <span class="o">-</span> <span class="nb">min</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="nb">max</span> <span class="o">-</span> <span class="nb">min</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">score</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h3 id="river_torch.anomaly.scaler.StandardScaler" class="doc doc-heading">
        <code>
StandardScaler            (<a class="autorefs autorefs-internal" title="river_torch.anomaly.base.AnomalyScaler" href="#river_torch.anomaly.base.AnomalyScaler">AnomalyScaler</a>)
        </code>



<a href="#river_torch.anomaly.scaler.StandardScaler" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Wrapper around an anomaly detector that standardizes the model's output using incremental mean and variance metrics.</p>
<h5 id="river_torch.anomaly.scaler.StandardScaler--parameters">Parameters<a class="headerlink" href="#river_torch.anomaly.scaler.StandardScaler--parameters" title="Permanent link">&para;</a></h5>
<p>anomaly_detector
    The anomaly detector to wrap.
with_std
    Whether to use standard deviation for scaling.
metric_type
    The type of metric to use.
window_size
    The window size used for the metrics if metric_type=="rolling".
alpha
    The alpha used for the metrics if metric_type=="adaptive".</p>

        <details class="quote">
          <summary>Source code in <code>river_torch/anomaly/scaler.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">StandardScaler</span><span class="p">(</span><span class="n">AnomalyScaler</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Wrapper around an anomaly detector that standardizes the model&#39;s output using incremental mean and variance metrics.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    anomaly_detector</span>
<span class="sd">        The anomaly detector to wrap.</span>
<span class="sd">    with_std</span>
<span class="sd">        Whether to use standard deviation for scaling.</span>
<span class="sd">    metric_type</span>
<span class="sd">        The type of metric to use.</span>
<span class="sd">    window_size</span>
<span class="sd">        The window size used for the metrics if metric_type==&quot;rolling&quot;.</span>
<span class="sd">    alpha</span>
<span class="sd">        The alpha used for the metrics if metric_type==&quot;adaptive&quot;.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">anomaly_detector</span><span class="p">:</span> <span class="n">AnomalyDetector</span><span class="p">,</span>
        <span class="n">with_std</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">metric_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;rolling&quot;</span><span class="p">,</span>
        <span class="n">window_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">250</span><span class="p">,</span>
        <span class="n">alpha</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">anomaly_detector</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">metric_type</span> <span class="o">=</span> <span class="n">metric_type</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span> <span class="o">=</span> <span class="n">alpha</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">window_size</span> <span class="o">=</span> <span class="n">window_size</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mean</span> <span class="o">=</span> <span class="n">_get_metric</span><span class="p">(</span><span class="s2">&quot;mean&quot;</span><span class="p">,</span> <span class="n">metric_type</span><span class="p">,</span> <span class="n">window_size</span><span class="p">,</span> <span class="n">alpha</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sq_mean</span> <span class="o">=</span> <span class="n">_get_metric</span><span class="p">(</span><span class="s2">&quot;mean&quot;</span><span class="p">,</span> <span class="n">metric_type</span><span class="p">,</span> <span class="n">window_size</span><span class="p">,</span> <span class="n">alpha</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">with_std</span> <span class="o">=</span> <span class="n">with_std</span>

    <span class="k">def</span> <span class="nf">score_one</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a scaled anomaly score based on raw score provided by the wrapped anomaly detector. Larger values indicate more anomalous examples.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        *args</span>
<span class="sd">            Depends on whether the underlying anomaly detector is supervised or not.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        An scaled anomaly score. Larger values indicate more anomalous examples.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">raw_score</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">anomaly_detector</span><span class="o">.</span><span class="n">score_one</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
        <span class="n">mean</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">raw_score</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">with_std</span><span class="p">:</span>
            <span class="n">var</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sq_mean</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">raw_score</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="o">-</span> <span class="n">mean</span><span class="o">**</span><span class="mi">2</span>
            <span class="n">score</span> <span class="o">=</span> <span class="p">(</span><span class="n">raw_score</span> <span class="o">-</span> <span class="n">mean</span><span class="p">)</span> <span class="o">/</span> <span class="n">var</span><span class="o">**</span><span class="mf">0.5</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">score</span> <span class="o">=</span> <span class="n">raw_score</span> <span class="o">-</span> <span class="n">mean</span>

        <span class="k">return</span> <span class="n">score</span>

    <span class="k">def</span> <span class="nf">score_many</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return scaled anomaly scores based on raw scores provided by the wrapped anomaly detector. Larger values indicate more anomalous examples.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        *args</span>
<span class="sd">            Depends on whether the underlying anomaly detector is supervised or not.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        An scaled anomaly score. Larger values indicate more anomalous examples.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">raw_scores</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">anomaly_detector</span><span class="o">.</span><span class="n">score_many</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
        <span class="n">mean</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="o">.</span><span class="n">update_many</span><span class="p">(</span><span class="n">raw_scores</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">with_std</span><span class="p">:</span>
            <span class="n">var</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sq_mean</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">raw_scores</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="o">-</span> <span class="n">mean</span><span class="o">**</span><span class="mi">2</span>
            <span class="n">scores</span> <span class="o">=</span> <span class="p">(</span><span class="n">raw_scores</span> <span class="o">-</span> <span class="n">mean</span><span class="p">)</span> <span class="o">/</span> <span class="n">var</span><span class="o">**</span><span class="mf">0.5</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">scores</span> <span class="o">=</span> <span class="n">raw_scores</span> <span class="o">-</span> <span class="n">mean</span>

        <span class="k">return</span> <span class="n">scores</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">










  <div class="doc doc-object doc-method">



<h4 id="river_torch.anomaly.scaler.StandardScaler.score_many" class="doc doc-heading">
<code class="highlight language-python"><span class="n">score_many</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span></code>


<a href="#river_torch.anomaly.scaler.StandardScaler.score_many" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Return scaled anomaly scores based on raw scores provided by the wrapped anomaly detector. Larger values indicate more anomalous examples.</p>
<h6 id="river_torch.anomaly.scaler.StandardScaler.score_many--parameters">Parameters<a class="headerlink" href="#river_torch.anomaly.scaler.StandardScaler.score_many--parameters" title="Permanent link">&para;</a></h6>
<p>*args
    Depends on whether the underlying anomaly detector is supervised or not.</p>
<h6 id="river_torch.anomaly.scaler.StandardScaler.score_many--returns">Returns<a class="headerlink" href="#river_torch.anomaly.scaler.StandardScaler.score_many--returns" title="Permanent link">&para;</a></h6>
<p>An scaled anomaly score. Larger values indicate more anomalous examples.</p>

        <details class="quote">
          <summary>Source code in <code>river_torch/anomaly/scaler.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">score_many</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return scaled anomaly scores based on raw scores provided by the wrapped anomaly detector. Larger values indicate more anomalous examples.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    *args</span>
<span class="sd">        Depends on whether the underlying anomaly detector is supervised or not.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    An scaled anomaly score. Larger values indicate more anomalous examples.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">raw_scores</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">anomaly_detector</span><span class="o">.</span><span class="n">score_many</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
    <span class="n">mean</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="o">.</span><span class="n">update_many</span><span class="p">(</span><span class="n">raw_scores</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">with_std</span><span class="p">:</span>
        <span class="n">var</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sq_mean</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">raw_scores</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="o">-</span> <span class="n">mean</span><span class="o">**</span><span class="mi">2</span>
        <span class="n">scores</span> <span class="o">=</span> <span class="p">(</span><span class="n">raw_scores</span> <span class="o">-</span> <span class="n">mean</span><span class="p">)</span> <span class="o">/</span> <span class="n">var</span><span class="o">**</span><span class="mf">0.5</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">scores</span> <span class="o">=</span> <span class="n">raw_scores</span> <span class="o">-</span> <span class="n">mean</span>

    <span class="k">return</span> <span class="n">scores</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="river_torch.anomaly.scaler.StandardScaler.score_one" class="doc doc-heading">
<code class="highlight language-python"><span class="n">score_one</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span></code>


<a href="#river_torch.anomaly.scaler.StandardScaler.score_one" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Return a scaled anomaly score based on raw score provided by the wrapped anomaly detector. Larger values indicate more anomalous examples.</p>
<h6 id="river_torch.anomaly.scaler.StandardScaler.score_one--parameters">Parameters<a class="headerlink" href="#river_torch.anomaly.scaler.StandardScaler.score_one--parameters" title="Permanent link">&para;</a></h6>
<p>*args
    Depends on whether the underlying anomaly detector is supervised or not.</p>
<h6 id="river_torch.anomaly.scaler.StandardScaler.score_one--returns">Returns<a class="headerlink" href="#river_torch.anomaly.scaler.StandardScaler.score_one--returns" title="Permanent link">&para;</a></h6>
<p>An scaled anomaly score. Larger values indicate more anomalous examples.</p>

        <details class="quote">
          <summary>Source code in <code>river_torch/anomaly/scaler.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">score_one</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return a scaled anomaly score based on raw score provided by the wrapped anomaly detector. Larger values indicate more anomalous examples.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    *args</span>
<span class="sd">        Depends on whether the underlying anomaly detector is supervised or not.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    An scaled anomaly score. Larger values indicate more anomalous examples.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">raw_score</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">anomaly_detector</span><span class="o">.</span><span class="n">score_one</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
    <span class="n">mean</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">raw_score</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">with_std</span><span class="p">:</span>
        <span class="n">var</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sq_mean</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">raw_score</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="o">-</span> <span class="n">mean</span><span class="o">**</span><span class="mi">2</span>
        <span class="n">score</span> <span class="o">=</span> <span class="p">(</span><span class="n">raw_score</span> <span class="o">-</span> <span class="n">mean</span><span class="p">)</span> <span class="o">/</span> <span class="n">var</span><span class="o">**</span><span class="mf">0.5</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">score</span> <span class="o">=</span> <span class="n">raw_score</span> <span class="o">-</span> <span class="n">mean</span>

    <span class="k">return</span> <span class="n">score</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>







  </div>

    </div>

  </div>




  </div>

    </div>

  </div>

<h1 id="anomaly-score-postprocessing">Anomaly score postprocessing<a class="headerlink" href="#anomaly-score-postprocessing" title="Permanent link">&para;</a></h1>


  <div class="doc doc-object doc-module">

<a id="river_torch.anomaly.scaler"></a>
    <div class="doc doc-contents first">




  <div class="doc doc-children">








  <div class="doc doc-object doc-class">



<h2 id="river_torch.anomaly.scaler.MeanScaler" class="doc doc-heading">
        <code>
MeanScaler            (<a class="autorefs autorefs-internal" title="river_torch.anomaly.base.AnomalyScaler" href="#river_torch.anomaly.base.AnomalyScaler">AnomalyScaler</a>)
        </code>



<a href="#river_torch.anomaly.scaler.MeanScaler" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Wrapper around an anomaly detector that scales the model's output by the incremental mean of previous scores.</p>
<h4 id="river_torch.anomaly.scaler.MeanScaler--parameters">Parameters<a class="headerlink" href="#river_torch.anomaly.scaler.MeanScaler--parameters" title="Permanent link">&para;</a></h4>
<p>anomaly_detector
    The anomaly detector to wrap.
metric_type
    The type of metric to use.
window_size
    The window size used for mean computation if metric_type=="rolling".
alpha
    The alpha used for mean computation if metric_type=="adaptive".</p>

        <details class="quote">
          <summary>Source code in <code>river_torch/anomaly/scaler.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">MeanScaler</span><span class="p">(</span><span class="n">AnomalyScaler</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Wrapper around an anomaly detector that scales the model&#39;s output by the incremental mean of previous scores.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    anomaly_detector</span>
<span class="sd">        The anomaly detector to wrap.</span>
<span class="sd">    metric_type</span>
<span class="sd">        The type of metric to use.</span>
<span class="sd">    window_size</span>
<span class="sd">        The window size used for mean computation if metric_type==&quot;rolling&quot;.</span>
<span class="sd">    alpha</span>
<span class="sd">        The alpha used for mean computation if metric_type==&quot;adaptive&quot;.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">anomaly_detector</span><span class="p">:</span> <span class="n">AnomalyDetector</span><span class="p">,</span>
        <span class="n">metric_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;rolling&quot;</span><span class="p">,</span>
        <span class="n">window_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">250</span><span class="p">,</span>
        <span class="n">alpha</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">anomaly_detector</span><span class="o">=</span><span class="n">anomaly_detector</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">metric_type</span> <span class="o">=</span> <span class="n">metric_type</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span> <span class="o">=</span> <span class="n">alpha</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">window_size</span> <span class="o">=</span> <span class="n">window_size</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mean</span> <span class="o">=</span> <span class="n">_get_metric</span><span class="p">(</span><span class="s2">&quot;mean&quot;</span><span class="p">,</span> <span class="n">metric_type</span><span class="p">,</span> <span class="n">window_size</span><span class="p">,</span> <span class="n">alpha</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">score_one</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a scaled anomaly score based on raw score provided by the wrapped anomaly detector. Larger values indicate more anomalous examples.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        *args</span>
<span class="sd">            Depends on whether the underlying anomaly detector is supervised or not.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        An scaled anomaly score. Larger values indicate more anomalous examples.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">raw_score</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">anomaly_detector</span><span class="o">.</span><span class="n">score_one</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
        <span class="n">mean</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">raw_score</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="n">score</span> <span class="o">=</span> <span class="n">raw_score</span> <span class="o">/</span> <span class="n">mean</span>

        <span class="k">return</span> <span class="n">score</span>

    <span class="k">def</span> <span class="nf">score_many</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return scaled anomaly scores based on raw scores provided by the wrapped anomaly detector. Larger values indicate more anomalous examples.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        *args</span>
<span class="sd">            Depends on whether the underlying anomaly detector is supervised or not.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        An scaled anomaly score. Larger values indicate more anomalous examples.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">raw_score</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">anomaly_detector</span><span class="o">.</span><span class="n">score_many</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
        <span class="n">mean</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="o">.</span><span class="n">update_many</span><span class="p">(</span><span class="n">raw_score</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="n">score</span> <span class="o">=</span> <span class="n">raw_score</span> <span class="o">/</span> <span class="n">mean</span>

        <span class="k">return</span> <span class="n">score</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">










  <div class="doc doc-object doc-method">



<h3 id="river_torch.anomaly.scaler.MeanScaler.score_many" class="doc doc-heading">
<code class="highlight language-python"><span class="n">score_many</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span></code>


<a href="#river_torch.anomaly.scaler.MeanScaler.score_many" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Return scaled anomaly scores based on raw scores provided by the wrapped anomaly detector. Larger values indicate more anomalous examples.</p>
<h5 id="river_torch.anomaly.scaler.MeanScaler.score_many--parameters">Parameters<a class="headerlink" href="#river_torch.anomaly.scaler.MeanScaler.score_many--parameters" title="Permanent link">&para;</a></h5>
<p>*args
    Depends on whether the underlying anomaly detector is supervised or not.</p>
<h5 id="river_torch.anomaly.scaler.MeanScaler.score_many--returns">Returns<a class="headerlink" href="#river_torch.anomaly.scaler.MeanScaler.score_many--returns" title="Permanent link">&para;</a></h5>
<p>An scaled anomaly score. Larger values indicate more anomalous examples.</p>

        <details class="quote">
          <summary>Source code in <code>river_torch/anomaly/scaler.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">score_many</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return scaled anomaly scores based on raw scores provided by the wrapped anomaly detector. Larger values indicate more anomalous examples.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    *args</span>
<span class="sd">        Depends on whether the underlying anomaly detector is supervised or not.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    An scaled anomaly score. Larger values indicate more anomalous examples.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">raw_score</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">anomaly_detector</span><span class="o">.</span><span class="n">score_many</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
    <span class="n">mean</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="o">.</span><span class="n">update_many</span><span class="p">(</span><span class="n">raw_score</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
    <span class="n">score</span> <span class="o">=</span> <span class="n">raw_score</span> <span class="o">/</span> <span class="n">mean</span>

    <span class="k">return</span> <span class="n">score</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="river_torch.anomaly.scaler.MeanScaler.score_one" class="doc doc-heading">
<code class="highlight language-python"><span class="n">score_one</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span></code>


<a href="#river_torch.anomaly.scaler.MeanScaler.score_one" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Return a scaled anomaly score based on raw score provided by the wrapped anomaly detector. Larger values indicate more anomalous examples.</p>
<h5 id="river_torch.anomaly.scaler.MeanScaler.score_one--parameters">Parameters<a class="headerlink" href="#river_torch.anomaly.scaler.MeanScaler.score_one--parameters" title="Permanent link">&para;</a></h5>
<p>*args
    Depends on whether the underlying anomaly detector is supervised or not.</p>
<h5 id="river_torch.anomaly.scaler.MeanScaler.score_one--returns">Returns<a class="headerlink" href="#river_torch.anomaly.scaler.MeanScaler.score_one--returns" title="Permanent link">&para;</a></h5>
<p>An scaled anomaly score. Larger values indicate more anomalous examples.</p>

        <details class="quote">
          <summary>Source code in <code>river_torch/anomaly/scaler.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">score_one</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return a scaled anomaly score based on raw score provided by the wrapped anomaly detector. Larger values indicate more anomalous examples.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    *args</span>
<span class="sd">        Depends on whether the underlying anomaly detector is supervised or not.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    An scaled anomaly score. Larger values indicate more anomalous examples.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">raw_score</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">anomaly_detector</span><span class="o">.</span><span class="n">score_one</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
    <span class="n">mean</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">raw_score</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
    <span class="n">score</span> <span class="o">=</span> <span class="n">raw_score</span> <span class="o">/</span> <span class="n">mean</span>

    <span class="k">return</span> <span class="n">score</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h2 id="river_torch.anomaly.scaler.MinMaxScaler" class="doc doc-heading">
        <code>
MinMaxScaler            (<a class="autorefs autorefs-internal" title="river_torch.anomaly.base.AnomalyScaler" href="#river_torch.anomaly.base.AnomalyScaler">AnomalyScaler</a>)
        </code>



<a href="#river_torch.anomaly.scaler.MinMaxScaler" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Wrapper around an anomaly detector that scales the model's output to <span class="arithmatex">\([0, 1]\)</span> using rolling min and max metrics.</p>
<h4 id="river_torch.anomaly.scaler.MinMaxScaler--parameters">Parameters<a class="headerlink" href="#river_torch.anomaly.scaler.MinMaxScaler--parameters" title="Permanent link">&para;</a></h4>
<p>anomaly_detector
    The anomaly detector to wrap.
metric_type
    The type of metric to use.
window_size
    The window size used for the metrics if metric_type=="rolling".
alpha
    The alpha used for the metrics if metric_type=="adaptive".</p>

        <details class="quote">
          <summary>Source code in <code>river_torch/anomaly/scaler.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">MinMaxScaler</span><span class="p">(</span><span class="n">AnomalyScaler</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Wrapper around an anomaly detector that scales the model&#39;s output to $[0, 1]$ using rolling min and max metrics.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    anomaly_detector</span>
<span class="sd">        The anomaly detector to wrap.</span>
<span class="sd">    metric_type</span>
<span class="sd">        The type of metric to use.</span>
<span class="sd">    window_size</span>
<span class="sd">        The window size used for the metrics if metric_type==&quot;rolling&quot;.</span>
<span class="sd">    alpha</span>
<span class="sd">        The alpha used for the metrics if metric_type==&quot;adaptive&quot;.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">anomaly_detector</span><span class="p">:</span> <span class="n">AnomalyDetector</span><span class="p">,</span>
        <span class="n">metric_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;rolling&quot;</span><span class="p">,</span>
        <span class="n">window_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">250</span><span class="p">,</span>
        <span class="n">alpha</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">anomaly_detector</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">metric_type</span> <span class="o">=</span> <span class="n">metric_type</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span> <span class="o">=</span> <span class="n">alpha</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">window_size</span> <span class="o">=</span> <span class="n">window_size</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">min</span> <span class="o">=</span> <span class="n">_get_metric</span><span class="p">(</span><span class="s2">&quot;min&quot;</span><span class="p">,</span> <span class="n">metric_type</span><span class="p">,</span> <span class="n">window_size</span><span class="p">,</span> <span class="n">alpha</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max</span> <span class="o">=</span> <span class="n">_get_metric</span><span class="p">(</span><span class="s2">&quot;max&quot;</span><span class="p">,</span> <span class="n">metric_type</span><span class="p">,</span> <span class="n">window_size</span><span class="p">,</span> <span class="n">alpha</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">score_one</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a scaled anomaly score based on raw score provided by the wrapped anomaly detector. Larger values indicate more anomalous examples.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        *args</span>
<span class="sd">            Depends on whether the underlying anomaly detector is supervised or not.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        An scaled anomaly score. Larger values indicate more anomalous examples.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">raw_score</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">anomaly_detector</span><span class="o">.</span><span class="n">score_one</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
        <span class="nb">min</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">min</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">raw_score</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="nb">max</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">max</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">raw_score</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="n">score</span> <span class="o">=</span> <span class="p">(</span><span class="n">raw_score</span> <span class="o">-</span> <span class="nb">min</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="nb">max</span> <span class="o">-</span> <span class="nb">min</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">score</span>

    <span class="k">def</span> <span class="nf">score_many</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return scaled anomaly scores based on raw scores provided by the wrapped anomaly detector. Larger values indicate more anomalous examples.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        *args</span>
<span class="sd">            Depends on whether the underlying anomaly detector is supervised or not.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        An scaled anomaly score. Larger values indicate more anomalous examples.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">raw_scores</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">anomaly_detector</span><span class="o">.</span><span class="n">score_many</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">raw_score</span> <span class="ow">in</span> <span class="n">raw_scores</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">min</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">raw_score</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">max</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">raw_score</span><span class="p">)</span>

        <span class="nb">min</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">min</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="nb">max</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">max</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="n">score</span> <span class="o">=</span> <span class="p">(</span><span class="n">raw_score</span> <span class="o">-</span> <span class="nb">min</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="nb">max</span> <span class="o">-</span> <span class="nb">min</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">score</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">










  <div class="doc doc-object doc-method">



<h3 id="river_torch.anomaly.scaler.MinMaxScaler.score_many" class="doc doc-heading">
<code class="highlight language-python"><span class="n">score_many</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span></code>


<a href="#river_torch.anomaly.scaler.MinMaxScaler.score_many" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Return scaled anomaly scores based on raw scores provided by the wrapped anomaly detector. Larger values indicate more anomalous examples.</p>
<h5 id="river_torch.anomaly.scaler.MinMaxScaler.score_many--parameters">Parameters<a class="headerlink" href="#river_torch.anomaly.scaler.MinMaxScaler.score_many--parameters" title="Permanent link">&para;</a></h5>
<p>*args
    Depends on whether the underlying anomaly detector is supervised or not.</p>
<h5 id="river_torch.anomaly.scaler.MinMaxScaler.score_many--returns">Returns<a class="headerlink" href="#river_torch.anomaly.scaler.MinMaxScaler.score_many--returns" title="Permanent link">&para;</a></h5>
<p>An scaled anomaly score. Larger values indicate more anomalous examples.</p>

        <details class="quote">
          <summary>Source code in <code>river_torch/anomaly/scaler.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">score_many</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return scaled anomaly scores based on raw scores provided by the wrapped anomaly detector. Larger values indicate more anomalous examples.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    *args</span>
<span class="sd">        Depends on whether the underlying anomaly detector is supervised or not.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    An scaled anomaly score. Larger values indicate more anomalous examples.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">raw_scores</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">anomaly_detector</span><span class="o">.</span><span class="n">score_many</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">raw_score</span> <span class="ow">in</span> <span class="n">raw_scores</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">min</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">raw_score</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">raw_score</span><span class="p">)</span>

    <span class="nb">min</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">min</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
    <span class="nb">max</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">max</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
    <span class="n">score</span> <span class="o">=</span> <span class="p">(</span><span class="n">raw_score</span> <span class="o">-</span> <span class="nb">min</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="nb">max</span> <span class="o">-</span> <span class="nb">min</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">score</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="river_torch.anomaly.scaler.MinMaxScaler.score_one" class="doc doc-heading">
<code class="highlight language-python"><span class="n">score_one</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span></code>


<a href="#river_torch.anomaly.scaler.MinMaxScaler.score_one" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Return a scaled anomaly score based on raw score provided by the wrapped anomaly detector. Larger values indicate more anomalous examples.</p>
<h5 id="river_torch.anomaly.scaler.MinMaxScaler.score_one--parameters">Parameters<a class="headerlink" href="#river_torch.anomaly.scaler.MinMaxScaler.score_one--parameters" title="Permanent link">&para;</a></h5>
<p>*args
    Depends on whether the underlying anomaly detector is supervised or not.</p>
<h5 id="river_torch.anomaly.scaler.MinMaxScaler.score_one--returns">Returns<a class="headerlink" href="#river_torch.anomaly.scaler.MinMaxScaler.score_one--returns" title="Permanent link">&para;</a></h5>
<p>An scaled anomaly score. Larger values indicate more anomalous examples.</p>

        <details class="quote">
          <summary>Source code in <code>river_torch/anomaly/scaler.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">score_one</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return a scaled anomaly score based on raw score provided by the wrapped anomaly detector. Larger values indicate more anomalous examples.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    *args</span>
<span class="sd">        Depends on whether the underlying anomaly detector is supervised or not.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    An scaled anomaly score. Larger values indicate more anomalous examples.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">raw_score</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">anomaly_detector</span><span class="o">.</span><span class="n">score_one</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
    <span class="nb">min</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">min</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">raw_score</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
    <span class="nb">max</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">max</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">raw_score</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
    <span class="n">score</span> <span class="o">=</span> <span class="p">(</span><span class="n">raw_score</span> <span class="o">-</span> <span class="nb">min</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="nb">max</span> <span class="o">-</span> <span class="nb">min</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">score</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h2 id="river_torch.anomaly.scaler.StandardScaler" class="doc doc-heading">
        <code>
StandardScaler            (<a class="autorefs autorefs-internal" title="river_torch.anomaly.base.AnomalyScaler" href="#river_torch.anomaly.base.AnomalyScaler">AnomalyScaler</a>)
        </code>



<a href="#river_torch.anomaly.scaler.StandardScaler" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Wrapper around an anomaly detector that standardizes the model's output using incremental mean and variance metrics.</p>
<h4 id="river_torch.anomaly.scaler.StandardScaler--parameters">Parameters<a class="headerlink" href="#river_torch.anomaly.scaler.StandardScaler--parameters" title="Permanent link">&para;</a></h4>
<p>anomaly_detector
    The anomaly detector to wrap.
with_std
    Whether to use standard deviation for scaling.
metric_type
    The type of metric to use.
window_size
    The window size used for the metrics if metric_type=="rolling".
alpha
    The alpha used for the metrics if metric_type=="adaptive".</p>

        <details class="quote">
          <summary>Source code in <code>river_torch/anomaly/scaler.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">StandardScaler</span><span class="p">(</span><span class="n">AnomalyScaler</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Wrapper around an anomaly detector that standardizes the model&#39;s output using incremental mean and variance metrics.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    anomaly_detector</span>
<span class="sd">        The anomaly detector to wrap.</span>
<span class="sd">    with_std</span>
<span class="sd">        Whether to use standard deviation for scaling.</span>
<span class="sd">    metric_type</span>
<span class="sd">        The type of metric to use.</span>
<span class="sd">    window_size</span>
<span class="sd">        The window size used for the metrics if metric_type==&quot;rolling&quot;.</span>
<span class="sd">    alpha</span>
<span class="sd">        The alpha used for the metrics if metric_type==&quot;adaptive&quot;.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">anomaly_detector</span><span class="p">:</span> <span class="n">AnomalyDetector</span><span class="p">,</span>
        <span class="n">with_std</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">metric_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;rolling&quot;</span><span class="p">,</span>
        <span class="n">window_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">250</span><span class="p">,</span>
        <span class="n">alpha</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">anomaly_detector</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">metric_type</span> <span class="o">=</span> <span class="n">metric_type</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span> <span class="o">=</span> <span class="n">alpha</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">window_size</span> <span class="o">=</span> <span class="n">window_size</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mean</span> <span class="o">=</span> <span class="n">_get_metric</span><span class="p">(</span><span class="s2">&quot;mean&quot;</span><span class="p">,</span> <span class="n">metric_type</span><span class="p">,</span> <span class="n">window_size</span><span class="p">,</span> <span class="n">alpha</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sq_mean</span> <span class="o">=</span> <span class="n">_get_metric</span><span class="p">(</span><span class="s2">&quot;mean&quot;</span><span class="p">,</span> <span class="n">metric_type</span><span class="p">,</span> <span class="n">window_size</span><span class="p">,</span> <span class="n">alpha</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">with_std</span> <span class="o">=</span> <span class="n">with_std</span>

    <span class="k">def</span> <span class="nf">score_one</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a scaled anomaly score based on raw score provided by the wrapped anomaly detector. Larger values indicate more anomalous examples.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        *args</span>
<span class="sd">            Depends on whether the underlying anomaly detector is supervised or not.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        An scaled anomaly score. Larger values indicate more anomalous examples.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">raw_score</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">anomaly_detector</span><span class="o">.</span><span class="n">score_one</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
        <span class="n">mean</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">raw_score</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">with_std</span><span class="p">:</span>
            <span class="n">var</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sq_mean</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">raw_score</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="o">-</span> <span class="n">mean</span><span class="o">**</span><span class="mi">2</span>
            <span class="n">score</span> <span class="o">=</span> <span class="p">(</span><span class="n">raw_score</span> <span class="o">-</span> <span class="n">mean</span><span class="p">)</span> <span class="o">/</span> <span class="n">var</span><span class="o">**</span><span class="mf">0.5</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">score</span> <span class="o">=</span> <span class="n">raw_score</span> <span class="o">-</span> <span class="n">mean</span>

        <span class="k">return</span> <span class="n">score</span>

    <span class="k">def</span> <span class="nf">score_many</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return scaled anomaly scores based on raw scores provided by the wrapped anomaly detector. Larger values indicate more anomalous examples.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        *args</span>
<span class="sd">            Depends on whether the underlying anomaly detector is supervised or not.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        An scaled anomaly score. Larger values indicate more anomalous examples.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">raw_scores</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">anomaly_detector</span><span class="o">.</span><span class="n">score_many</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
        <span class="n">mean</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="o">.</span><span class="n">update_many</span><span class="p">(</span><span class="n">raw_scores</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">with_std</span><span class="p">:</span>
            <span class="n">var</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sq_mean</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">raw_scores</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="o">-</span> <span class="n">mean</span><span class="o">**</span><span class="mi">2</span>
            <span class="n">scores</span> <span class="o">=</span> <span class="p">(</span><span class="n">raw_scores</span> <span class="o">-</span> <span class="n">mean</span><span class="p">)</span> <span class="o">/</span> <span class="n">var</span><span class="o">**</span><span class="mf">0.5</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">scores</span> <span class="o">=</span> <span class="n">raw_scores</span> <span class="o">-</span> <span class="n">mean</span>

        <span class="k">return</span> <span class="n">scores</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">










  <div class="doc doc-object doc-method">



<h3 id="river_torch.anomaly.scaler.StandardScaler.score_many" class="doc doc-heading">
<code class="highlight language-python"><span class="n">score_many</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span></code>


<a href="#river_torch.anomaly.scaler.StandardScaler.score_many" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Return scaled anomaly scores based on raw scores provided by the wrapped anomaly detector. Larger values indicate more anomalous examples.</p>
<h5 id="river_torch.anomaly.scaler.StandardScaler.score_many--parameters">Parameters<a class="headerlink" href="#river_torch.anomaly.scaler.StandardScaler.score_many--parameters" title="Permanent link">&para;</a></h5>
<p>*args
    Depends on whether the underlying anomaly detector is supervised or not.</p>
<h5 id="river_torch.anomaly.scaler.StandardScaler.score_many--returns">Returns<a class="headerlink" href="#river_torch.anomaly.scaler.StandardScaler.score_many--returns" title="Permanent link">&para;</a></h5>
<p>An scaled anomaly score. Larger values indicate more anomalous examples.</p>

        <details class="quote">
          <summary>Source code in <code>river_torch/anomaly/scaler.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">score_many</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return scaled anomaly scores based on raw scores provided by the wrapped anomaly detector. Larger values indicate more anomalous examples.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    *args</span>
<span class="sd">        Depends on whether the underlying anomaly detector is supervised or not.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    An scaled anomaly score. Larger values indicate more anomalous examples.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">raw_scores</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">anomaly_detector</span><span class="o">.</span><span class="n">score_many</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
    <span class="n">mean</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="o">.</span><span class="n">update_many</span><span class="p">(</span><span class="n">raw_scores</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">with_std</span><span class="p">:</span>
        <span class="n">var</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sq_mean</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">raw_scores</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="o">-</span> <span class="n">mean</span><span class="o">**</span><span class="mi">2</span>
        <span class="n">scores</span> <span class="o">=</span> <span class="p">(</span><span class="n">raw_scores</span> <span class="o">-</span> <span class="n">mean</span><span class="p">)</span> <span class="o">/</span> <span class="n">var</span><span class="o">**</span><span class="mf">0.5</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">scores</span> <span class="o">=</span> <span class="n">raw_scores</span> <span class="o">-</span> <span class="n">mean</span>

    <span class="k">return</span> <span class="n">scores</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="river_torch.anomaly.scaler.StandardScaler.score_one" class="doc doc-heading">
<code class="highlight language-python"><span class="n">score_one</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span></code>


<a href="#river_torch.anomaly.scaler.StandardScaler.score_one" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Return a scaled anomaly score based on raw score provided by the wrapped anomaly detector. Larger values indicate more anomalous examples.</p>
<h5 id="river_torch.anomaly.scaler.StandardScaler.score_one--parameters">Parameters<a class="headerlink" href="#river_torch.anomaly.scaler.StandardScaler.score_one--parameters" title="Permanent link">&para;</a></h5>
<p>*args
    Depends on whether the underlying anomaly detector is supervised or not.</p>
<h5 id="river_torch.anomaly.scaler.StandardScaler.score_one--returns">Returns<a class="headerlink" href="#river_torch.anomaly.scaler.StandardScaler.score_one--returns" title="Permanent link">&para;</a></h5>
<p>An scaled anomaly score. Larger values indicate more anomalous examples.</p>

        <details class="quote">
          <summary>Source code in <code>river_torch/anomaly/scaler.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">score_one</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return a scaled anomaly score based on raw score provided by the wrapped anomaly detector. Larger values indicate more anomalous examples.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    *args</span>
<span class="sd">        Depends on whether the underlying anomaly detector is supervised or not.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    An scaled anomaly score. Larger values indicate more anomalous examples.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">raw_score</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">anomaly_detector</span><span class="o">.</span><span class="n">score_one</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
    <span class="n">mean</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">raw_score</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">with_std</span><span class="p">:</span>
        <span class="n">var</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sq_mean</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">raw_score</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="o">-</span> <span class="n">mean</span><span class="o">**</span><span class="mi">2</span>
        <span class="n">score</span> <span class="o">=</span> <span class="p">(</span><span class="n">raw_score</span> <span class="o">-</span> <span class="n">mean</span><span class="p">)</span> <span class="o">/</span> <span class="n">var</span><span class="o">**</span><span class="mf">0.5</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">score</span> <span class="o">=</span> <span class="n">raw_score</span> <span class="o">-</span> <span class="n">mean</span>

    <span class="k">return</span> <span class="n">score</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>







  </div>

    </div>

  </div>

              
            </article>
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../installation/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Installation" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Installation
            </div>
          </div>
        </a>
      
      
        
        <a href="../classification/" class="md-footer__link md-footer__link--next" aria-label="Next: Classification" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Classification
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2019 - 2022
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
      
      
    
    <a href="https://github.com/online-ml/river-torch" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 480 512"><!--! Font Awesome Free 6.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.instant", "navigation.tabs", "navigation.indexes", "navigation.tracking"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../assets/javascripts/workers/search.092fa1f6.min.js", "version": [{"provider": "mike"}]}</script>
    
    
      <script src="../assets/javascripts/bundle.5a9542cf.min.js"></script>
      
    
  </body>
</html>